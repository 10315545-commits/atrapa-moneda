<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Atrapa la Moneda ‚Äì V6.0</title>
<style>
  body{
    margin:0;
    background: linear-gradient(to bottom,#0f0f0f,#111111);
    color:white;
    font-family:Arial;
    text-align:center;
    overflow-x:hidden;
  }
  h1{
    color:#ff77aa;
    text-shadow:0 0 15px #ff77aa, 0 0 20px #ff44cc;
  }
  button{
    padding:10px 20px;
    font-size:16px;
    border:none;
    border-radius:10px;
    cursor:pointer;
    margin:3px;
    color:white;
    font-weight:bold;
    box-shadow:0 0 5px #ff44cc;
  }
  #game, #adminPanel{
    display:none;
  }
  #moneda{
    font-size:80px;
    margin:20px;
  }
  .info{
    font-size:18px;
    margin:5px;
  }
  .fallingCoin,.diamond,.bossCoin{
    position:absolute;
    top:-50px;
    user-select:none;
    pointer-events:none;
  }
  .fallingCoin{ font-size:40px; color:yellow; animation:caer linear forwards;}
  .diamond{ font-size:35px; color:#00ffff; animation:caer linear forwards;}
  .bossCoin{ font-size:50px; color:#ff44cc; animation:caer linear forwards;}
  @keyframes caer{
    0% {top:-50px; opacity:1;}
    100% {top:90vh; opacity:0;}
  }
  .tabButton.active{
    background:#ff44cc;
    box-shadow:0 0 10px #ff44cc;
  }
  #eventHistory{
    max-height:150px;
    overflow-y:auto;
    border:1px solid #ff44cc;
    margin-top:5px;
    padding:5px;
    font-size:14px;
    text-align:left;
  }
</style>
</head>
<body>

<h1>üéÆ ATRAPA LA MONEDA V6.0</h1>

<div id="menu">
  <button onclick="iniciar()">INICIAR JUEGO</button>
  <button onclick="pedirClaseAdmin()">ADMIN LOGIN</button>
</div>

<div id="game">
  <h2 id="moneda">‚ùì</h2>
  <p>Presiona L, C o R</p>
  <div class="info" id="stats"></div>
</div>

<div id="adminPanel">
  <h2>‚ö° ADMIN PANEL ‚ö°</h2>
  <p>Clase: <span id="adminClase"></span></p>
  <div>
    <button class="tabButton active" onclick="cambiarPestana('party')">Party</button>
    <button class="tabButton" onclick="cambiarPestana('diamonds')">Rain Diamonds</button>
    <button class="tabButton" onclick="cambiarPestana('boss')">Boss Event</button>
    <button onclick="comandoVidaInfinita()">Vida Infinita</button>
    <button onclick="cerrarAdminPanel()">Cerrar Panel</button>
  </div>
  <div id="eventHistory"></div>
</div>

<script>
// VARIABLES PRINCIPALES
let pesos=0, vidas=5, record=localStorage.getItem("record")||0;
let secuencia=["R","L","C","L","R","C","R"], indice=0;
let monedaActual="", velocidad=1500, intervalo;
let vidaInfinita=false, claseAdmin="";

// ELEMENTOS
const monedaEl=document.getElementById("moneda");
const statsEl=document.getElementById("stats");
const adminClaseEl=document.getElementById("adminClase");
const eventHistoryEl=document.getElementById("eventHistory");

// SONIDOS
const coinSound=new Audio("https://freesound.org/data/previews/341/341695_62435-lq.mp3");
const bossSound=new Audio("https://freesound.org/data/previews/331/331912_3248240-lq.mp3");

// INICIAR JUEGO
function iniciar(){
  document.getElementById("menu").style.display="none";
  document.getElementById("game").style.display="block";
  resetGame();
}

// RESET GAME
function resetGame(){
  pesos=0; vidas=5; velocidad=1500; indice=0; vidaInfinita=false;
  actualizarStats();
  nuevaMoneda();
  clearInterval(intervalo);
  intervalo=setInterval(tiempoAgotado, velocidad);
}

// NUEVA MONEDA
function nuevaMoneda(){
  monedaActual=secuencia[indice];
  monedaEl.innerText=monedaActual;
  indice++; if(indice>=secuencia.length) indice=0;
  crearMonedaCayendo("üí∞");
}

// ACTUALIZAR STATS
function actualizarStats(){
  statsEl.innerText="Pesos: "+pesos+" | Vidas: "+(vidaInfinita?"‚àû":vidas)+" | R√©cord: "+record;
}

// TIEMPO AGOTADO
function tiempoAgotado(){
  if(!vidaInfinita) vidas--;
  actualizarStats();
  if(vidas<=0 && !vidaInfinita){ gameOver(); return;}
  nuevaMoneda();
}

// GAME OVER
function gameOver(){
  clearInterval(intervalo);
  if(pesos>record){ record=pesos; localStorage.setItem("record",record);}
  alert("GAME OVER\nPuntaje: "+pesos);
  resetGame();
}

// TECLAS
document.addEventListener("keydown", function(e){
  const eleccion=e.key.toUpperCase();
  if(!["L","C","R"].includes(eleccion)) return;
  if(eleccion===monedaActual){
    pesos++; coinSound.play();
    velocidad-=50; if(velocidad<500) velocidad=500;
    clearInterval(intervalo);
    intervalo=setInterval(tiempoAgotado, velocidad);
  }else{
    if(!vidaInfinita) vidas--;
  }
  actualizarStats();
  if(vidas<=0 && !vidaInfinita){ gameOver(); return;}
  nuevaMoneda();
});

// ANIMACIONES
function crearMonedaCayendo(simbolo,color="#FFFF00"){
  const c=document.createElement("div");
  c.className="fallingCoin";
  c.innerText=simbolo;
  c.style.left=Math.random()*90+"vw";
  c.style.color=color;
  c.style.animationDuration=(2+Math.random()*1.5)+"s";
  document.body.appendChild(c);
  setTimeout(()=>c.remove(),3000);
}

// ADMIN PANEL
function pedirClaseAdmin(){
  const clave=prompt("Introduce la clave de tu clase admin:");
  if(clave==="ruler admin"){
    claseAdmin=clave;
    adminClaseEl.innerText=claseAdmin;
    mostrarAdminPanel();
  } else{ alert("Clase incorrecta"); }
}
function mostrarAdminPanel(){ document.getElementById("adminPanel").style.display="block"; }
function cerrarAdminPanel(){ document.getElementById("adminPanel").style.display="none"; }

// PESTA√ëAS
function cambiarPestana(tipo){
  const buttons=document.getElementsByClassName("tabButton");
  for(let b of buttons){ b.classList.remove("active"); }
  if(tipo==="party") buttons[0].classList.add("active");
  if(tipo==="diamonds") buttons[1].classList.add("active");
  if(tipo==="boss") buttons[2].classList.add("active");

  if(tipo==="party") comandoParty();
  if(tipo==="diamonds") comandoRainDiamonds();
  if(tipo==="boss") comandoBoss();
}

// EVENTOS ADMIN
function comandoParty(){ for(let i=0;i<20;i++){ crearMonedaCayendo("üí∞","yellow"); pesos++; } registrarEvento("Party activado!"); actualizarStats();}
function comandoRainDiamonds(){ for(let i=0;i<30;i++){ crearMonedaCayendo("üíé","#00ffff"); pesos+=2; } registrarEvento("Rain Diamonds!"); actualizarStats();}
function comandoBoss(){ bossSound.currentTime=0; bossSound.play(); for(let i=0;i<50;i++){ crearMonedaCayendo("üëë","#ff44cc"); pesos+=5; } registrarEvento("Boss Event activado!"); actualizarStats();}
function comandoVidaInfinita(){ vidaInfinita=true; mostrarMensaje("Modo Vida Infinita Activado! ‚ôæÔ∏è"); registrarEvento("Vida Infinita activada"); actualizarStats();}

// MENSAJES
function mostrarMensaje(texto){ alert(texto); }

// HISTORIAL
function registrarEvento(texto){
  const e=document.createElement("div");
  e.innerText=(new Date()).toLocaleTimeString()+" ‚Üí "+texto;
  eventHistoryEl.prepend(e);
}
</script>

</body>
</html>
