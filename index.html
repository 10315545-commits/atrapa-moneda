<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Atrapa la Moneda 2.0</title>

<style>
body{
  margin:0;
  background:linear-gradient(180deg,#0f0f0f,#1a1a1a);
  color:white;
  font-family:Arial;
  text-align:center;
  overflow:hidden;
}

h1{
  color:#00ffcc;
  text-shadow:0 0 15px #00ffcc;
}

#menu{
  margin-top:80px;
}

button{
  padding:15px 30px;
  font-size:20px;
  background:#00ffcc;
  border:none;
  border-radius:15px;
  cursor:pointer;
}

#game{
  display:none;
  margin-top:20px;
}

#zona{
  position:relative;
  width:100%;
  height:200px;
  margin-top:20px;
}

#moneda{
  position:absolute;
  top:50px;
  font-size:80px;
  transition: left 0.3s ease;
}

#botones{
  position:fixed;
  bottom:20px;
  width:100%;
  display:flex;
  justify-content:space-around;
}

#botones button{
  width:90px;
  height:90px;
  font-size:28px;
  border-radius:20px;
}

.info{
  margin-top:10px;
  font-size:18px;
}
</style>
</head>
<body>

<h1>ðŸŽ® ATRAPA LA MONEDA</h1>

<div id="menu">
  <button onclick="iniciar()">INICIAR</button>
</div>

<div id="game">

  <div id="zona">
    <div id="moneda">ðŸª™</div>
  </div>

  <div class="info" id="stats"></div>

  <div id="botones">
    <button onclick="respuesta('L')">L</button>
    <button onclick="respuesta('C')">C</button>
    <button onclick="respuesta('R')">R</button>
  </div>

</div>

<script>

let pesos = 0;
let vidas = 5;
let record = localStorage.getItem("record") || 0;

let posiciones = {
  "L": "10%",
  "C": "40%",
  "R": "70%"
};

let secuencia = ["R","L","C","L","R","C","R"];
let indice = 0;

let monedaActual = "";
let velocidad = 1500;
let intervalo;

const monedaEl = document.getElementById("moneda");
const statsEl = document.getElementById("stats");

function iniciar(){
  document.getElementById("menu").style.display="none";
  document.getElementById("game").style.display="block";
  resetGame();
}

function resetGame(){
  pesos = 0;
  vidas = 5;
  velocidad = 1500;
  indice = 0;
  actualizarStats();
  nuevaMoneda();
  clearInterval(intervalo);
  intervalo = setInterval(tiempoAgotado, velocidad);
}

function nuevaMoneda(){
  monedaActual = secuencia[indice];
  monedaEl.style.left = posiciones[monedaActual];

  indice++;
  if(indice >= secuencia.length){
    indice = 0;
  }
}

function actualizarStats(){
  statsEl.innerText = 
    "Pesos: " + pesos + 
    " | Vidas: " + vidas + 
    " | RÃ©cord: " + record;
}

function tiempoAgotado(){
  vidas--;
  actualizarStats();

  if(vidas <= 0){
    gameOver();
  }

  nuevaMoneda();
}

function respuesta(eleccion){

  if(eleccion === monedaActual){
    pesos++;
    velocidad -= 50;
    if(velocidad < 500) velocidad = 500;

    clearInterval(intervalo);
    intervalo = setInterval(tiempoAgotado, velocidad);
  }else{
    vidas--;
  }

  actualizarStats();

  if(vidas <= 0){
    gameOver();
  }

  nuevaMoneda();
}

function gameOver(){
  clearInterval(intervalo);

  if(pesos > record){
    record = pesos;
    localStorage.setItem("record", record);
  }

  alert("GAME OVER\nPuntaje: " + pesos);
  resetGame();
}

/* Soporte teclado */
document.addEventListener("keydown", function(e){
  const tecla = e.key.toUpperCase();
  if(["L","C","R"].includes(tecla)){
    respuesta(tecla);
  }
});

</script>

</body>
</html>
