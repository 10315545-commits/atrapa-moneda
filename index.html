<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>Atrapa la Moneda V12.1 Ultra Arcade</title>
<style>
body{
  margin:0;
  background: linear-gradient(to bottom,#0f0f0f,#111133);
  color:white;
  font-family: Arial, sans-serif;
  text-align:center;
  overflow-x:hidden;
}
h1{
  color:#00ffcc;
  text-shadow:0 0 20px #00ffcc,0 0 30px #00ffaa;
}
button{
  padding:10px 20px;
  font-size:16px;
  border:none;
  border-radius:12px;
  cursor:pointer;
  margin:5px;
  font-weight:bold;
  color:white;
  background: linear-gradient(145deg,#222233,#444466);
  box-shadow:0 0 10px #00ffcc;
  transition: all 0.2s ease;
}
button:hover{
  background: linear-gradient(145deg,#00ffcc,#00aa88);
  box-shadow: 0 0 20px #00ffcc;
  color:#0f0f0f;
}
#game, #adminPanel{
  display:none;
  background: linear-gradient(to bottom,#111122,#222244);
  padding:15px;
  border-radius:12px;
  box-shadow:0 0 20px #00ffcc;
  margin:10px auto;
  max-width: 400px;
}
#moneda{
  font-size:80px;
  margin:20px;
  text-shadow:0 0 15px #ffff66;
}
.info{
  font-size:18px;
  margin:5px;
}
.fallingCoin,.diamond,.bossCoin,.miniBoss,.bossFinal{
  position:absolute;
  top:0px;
  user-select:none;
  pointer-events:none;
  transform-origin:center;
}
.fallingCoin{ font-size:40px; color:yellow; }
.diamond{ font-size:35px; color:#00ffff; }
.bossCoin{ font-size:50px; color:#ff44cc; }
.miniBoss{ font-size:45px; color:#ffbb33; }
.bossFinal{ font-size:80px; color:#ff0000; }
#eventHistory{
  max-height:180px;
  overflow-y:auto;
  border:1px solid #00ffcc;
  margin-top:5px;
  padding:5px;
  font-size:14px;
  text-align:left;
  background:#111122;
  border-radius:8px;
}
#ranking{
  max-height:100px;
  overflow-y:auto;
  border:1px solid #00ffcc;
  margin-top:5px;
  padding:5px;
  font-size:14px;
  background:#111122;
  border-radius:8px;
  text-align:left;
}
#messages{
  position:fixed;
  top:10px;
  left:50%;
  transform:translateX(-50%);
  background: rgba(0,0,0,0.8);
  padding:10px 20px;
  border-radius:12px;
  color:#fff;
  font-weight:bold;
  display:none;
  z-index:1000;
}

/* Part√≠culas */
.particle{
  position:absolute;
  width:6px; height:6px;
  background:yellow;
  border-radius:50%;
  opacity:0.8;
  pointer-events:none;
  transform:translate(-50%,-50%);
  animation:particleAnim 0.8s linear forwards;
}
@keyframes particleAnim{
  0%{transform:translate(-50%,-50%) scale(1); opacity:1;}
  100%{transform:translate(calc(-50% + var(--dx)), calc(-50% + var(--dy))) scale(0); opacity:0;}
}
</style>
</head>
<body>

<h1>üéÆ ATRAPA LA MONEDA V12.1 Ultra Arcade</h1>

<div id="menu">
  <button onclick="iniciar()">INICIAR JUEGO</button>
  <button onclick="showAdmin()" id="adminBtn">Admin Panel</button>
  <input type="color" id="userSkin" value="#00ffcc" onchange="applySkin(this.value)">
</div>

<div id="game">
  <h2 id="moneda">‚ùì</h2>
  <p>Presiona L, C o R</p>
  <div class="info" id="stats"></div>
  <div id="ranking"></div>
</div>

<div id="adminPanel">
  <h3>ADMIN PANEL (Owner)</h3>
  <button onclick="triggerEvent('party',true)">Party</button>
  <button onclick="triggerEvent('clear',true)">Clear Coins</button>
  <button onclick="triggerEvent('rainDiamonds',true)">Rain Diamonds</button>
  <button onclick="triggerEvent('superParty',true)">Super Party</button>
  <button onclick="triggerEvent('meteorShower',true)">Meteor Shower</button>
  <button onclick="toggleInfiniteLife()">Vida Infinita</button>
  <button onclick="ownerMessagePrompt()">Enviar Mensaje</button>
  <div id="eventHistory"></div>
</div>

<div id="messages"></div>

<audio id="coinSound" src="https://freesound.org/data/previews/341/341695_624578-lq.mp3"></audio>
<audio id="bossSound" src="https://freesound.org/data/previews/186/186942_351137-lq.mp3"></audio>
<audio id="diamondSound" src="https://freesound.org/data/previews/276/276020_5121236-lq.mp3"></audio>

<script>
// Base variables
let pesos=0, vidas=5, infiniteLife=false, level=1;
let record=localStorage.getItem("record")||0;
let secuencia=["R","L","C","L","R","C","R"], indice=0, monedaActual="";
let velocidad=1500, intervalo;
let rankingList=[];
const ownerClass="ruler";
let userSkinColor="#00ffcc";

// DOM
const monedaEl=document.getElementById("moneda");
const statsEl=document.getElementById("stats");
const adminPanel=document.getElementById("adminPanel");
const eventHistory=document.getElementById("eventHistory");
const rankingEl=document.getElementById("ranking");
const messagesEl=document.getElementById("messages");
const coinSound=document.getElementById("coinSound");
const bossSound=document.getElementById("bossSound");
const diamondSound=document.getElementById("diamondSound");

// Skin
function applySkin(color){
  userSkinColor=color;
  document.querySelectorAll('button').forEach(btn=>btn.style.boxShadow="0 0 10px "+color);
  monedaEl.style.textShadow="0 0 15px "+color;
}

// Iniciar
function iniciar(){
  document.getElementById("menu").style.display="none";
  document.getElementById("game").style.display="block";
  resetGame();
  spawnMiniBosses();
  startDailyEvents();
}

// Reset
function resetGame(){
  pesos=0; vidas=5; velocidad=1500; indice=0; level=1;
  actualizarStats();
  nuevaMoneda();
  clearInterval(intervalo);
  intervalo=setInterval(tiempoAgotado,velocidad);
}

// Nueva moneda
function nuevaMoneda(){
  monedaActual=secuencia[indice];
  monedaEl.innerText=monedaActual;
  crearMoneda(monedaActual);
  indice++; if(indice>=secuencia.length) indice=0;
}

// Stats
function actualizarStats(){
  statsEl.innerText="Pesos: "+pesos+" | Vidas: "+(infiniteLife?"‚àû":vidas)+" | Nivel: "+level+" | R√©cord: "+record;
  if(pesos>0 && pesos%50===0) level=Math.floor(pesos/50)+1;
  actualizarRanking();
}
function actualizarRanking(){
  rankingEl.innerHTML="Ranking:<br>"+rankingList.slice(-5).reverse().map((v,i)=> (i+1)+". "+v).join("<br>");
}

// Tiempo agotado
function tiempoAgotado(){
  if(!infiniteLife) vidas--;
  actualizarStats();
  if(vidas<=0) gameOver();
  nuevaMoneda();
}

// Game over
function gameOver(){
  clearInterval(intervalo);
  if(pesos>record){ record=pesos; localStorage.setItem("record",record); }
  rankingList.push(pesos);
  showMessage("GAME OVER! Puntaje: "+pesos,2000);
  resetGame();
}

// Teclas
document.addEventListener("keydown",function(e){
  const eleccion=e.key.toUpperCase();
  if(!["L","C","R"].includes(eleccion)) return;
  if(eleccion===monedaActual){ pesos++; coinSound.play(); velocidad-=50; if(velocidad<500) velocidad=500;
    clearInterval(intervalo); intervalo=setInterval(tiempoAgotado,velocidad);
  } else { if(!infiniteLife) vidas--; }
  actualizarStats();
  if(vidas<=0) gameOver();
  nuevaMoneda();
});

// Crear part√≠culas
function createParticles(x,y,color){
  for(let i=0;i<8;i++){
    const p=document.createElement("div");
    p.className="particle";
    p.style.left=x+"px";
    p.style.top=y+"px";
    p.style.background=color;
    p.style.setProperty("--dx",(Math.random()*40-20)+"px");
    p.style.setProperty("--dy",(Math.random()*40-20)+"px");
    document.body.appendChild(p);
    setTimeout(()=>p.remove(),800);
  }
}

// Crear monedas con part√≠culas
function crearMoneda(tipo){
  const coin=document.createElement("div");
  coin.style.left=Math.random()*90+"vw";
  coin.style.fontWeight="bold";
  coin.style.textShadow="0 0 10px "+userSkinColor+",0 0 20px #fff";
  coin.style.position="absolute";
  coin.style.top="-50px";
  coin.style.pointerEvents="none";
  let emoji="ü™ô", sound=coinSound, color="yellow";
  if(tipo==="R") {emoji="üí∞"; sound=bossSound; color="#ff44cc";}
  if(tipo==="diamond") {emoji="üíé"; sound=diamondSound; color="#00ffff";}
  if(tipo==="bossFinal"){emoji="üëë"; sound=bossSound; color="#ff0000";}
  coin.innerText=emoji; document.body.appendChild(coin);
  sound.play();
  let posY=-50, velocityY=2+Math.random()*3, bounce=0.6;
  const anim=setInterval(()=>{
    posY+=velocityY; velocityY+=0.2;
    if(posY>window.innerHeight-50){
      posY=window.innerHeight-50; 
      velocityY*=-bounce;
      createParticles(coin.offsetLeft+25,posY+25,color); // part√≠culas al suelo
    }
    coin.style.top=posY+"px";
  },20);
  setTimeout(()=>{clearInterval(anim); coin.remove();},4000);
}

// Admin panel
function showAdmin(){ if(ownerClass!=="ruler") return alert("Solo el owner"); adminPanel.style.display=adminPanel.style.display==="block"?"none":"block"; }

// Eventos
function triggerEvent(event,isAdmin=false){
  if(event==="party"){ for(let i=0;i<10;i++) crearMoneda("C"); pesos+=(isAdmin?10:5); logEvent("Party +"+(isAdmin?10:5),isAdmin); showMessage("Party +"+(isAdmin?10:5)); }
  if(event==="superParty"){ for(let i=0;i<30;i++) crearMoneda("C"); pesos+=(isAdmin?30:15); logEvent("Super Party +"+(isAdmin?30:15),isAdmin); showMessage("Super Party +"+(isAdmin?30:15)); }
  if(event==="rainDiamonds"){ for(let i=0;i<15;i++) crearMoneda("diamond"); pesos+=(isAdmin?20:10); diamondSound.play(); logEvent("Rain Diamonds +"+(isAdmin?20:10),isAdmin); showMessage("Rain Diamonds +"+(isAdmin?20:10)); }
  if(event==="meteorShower"){ for(let i=0;i<20;i++){ crearMoneda(Math.random()<0.3?"diamond":"C"); } pesos+=(isAdmin?25:12); logEvent("Meteor Shower +"+(isAdmin?25:12),isAdmin); showMessage("Meteor Shower +"+(isAdmin?25:12)); }
  if(event==="clear"){ document.querySelectorAll(".fallingCoin,.diamond,.bossCoin,.miniBoss").forEach(c=>c.remove()); logEvent("Monedas limpiadas",true); showMessage("Monedas limpiadas"); }
}

// Event history
function logEvent(msg,isPrivate=false){ const p=document.createElement("p"); p.innerText=msg; if(isPrivate) p.style.color="#ff88ff"; eventHistory.appendChild(p); eventHistory.scrollTop=eventHistory.scrollHeight; }

// Vida infinita
function toggleInfiniteLife(){ infiniteLife=!infiniteLife; logEvent("Vida infinita "+(infiniteLife?"activada":"desactivada"),true); actualizarStats(); }

// Mensajes owner
function ownerMessagePrompt(){ if(ownerClass!=="ruler") return; const msg=prompt("Mensaje P√∫blico del Owner:"); if(msg) showMessage(msg,3000); }
function showMessage(msg,duration=2000){ messagesEl.innerText=msg; messagesEl.style.display="block"; messagesEl.style.opacity=0; let op=0; const fadeIn=setInterval(()=>{ if(op<1){ op+=0.05; messagesEl.style.opacity=op; }else clearInterval(fadeIn); },20); setTimeout(()=>{ let op2=1; const fadeOut=setInterval(()=>{ if(op2>0){ op2-=0.05; messagesEl.style.opacity=op2; }else{ clearInterval(fadeOut); messagesEl.style.display="none"; } },20); },duration); }

// MiniBosses
function spawnMiniBosses(){
  setInterval(()=>{
    if(Math.random()<0.08){
      const mb=document.createElement("div");
      mb.className="miniBoss"; mb.innerText="üëæ";
      mb.style.left=Math.random()*90+"vw";
      mb.style.fontSize="45px";
      mb.style.top="-50px";
      document.body.appendChild(mb);
      let attacked=false;
      let posY=-50, velocityY=2+Math.random()*2, bounce=0.5;
      const anim=setInterval(()=>{
        posY+=velocityY; velocityY+=0.2;
        if(posY>window.innerHeight-50){ posY=window.innerHeight-50; velocityY*=-bounce; createParticles(mb.offsetLeft+25,posY+25,"#ffbb33"); }
        mb.style.top=posY+"px";
      },20);
      const attackTimeout=setTimeout(()=>{
        if(!attacked && !infiniteLife){ vidas--; showMessage("MiniBoss atac√≥ -1 vida"); actualizarStats(); }
        clearInterval(anim); mb.remove();
      },3000);
      mb.onclick=()=>{
        attacked=true; pesos+=5; coinSound.play(); actualizarStats(); showMessage("MiniBoss atrapado +5 monedas"); clearTimeout(attackTimeout); clearInterval(anim); mb.remove();
      };
    }
  },1000);
}

// Eventos autom√°ticos
function startDailyEvents(){ setInterval(()=>{ const events=["party","rainDiamonds"]; const e=events[Math.floor(Math.random()*events.length)]; triggerEvent(e,false); },30000); }

</script>
</body>
</html>
